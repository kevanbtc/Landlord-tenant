<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patterstone Case - Evidence Verification Portal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 100%);
            color: #e0e0e0;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            background: rgba(20, 20, 40, 0.95);
            border-left: 4px solid #0066cc;
            padding: 30px;
            margin-bottom: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            color: #0099ff;
        }
        
        header p {
            color: #a0a0c0;
            font-size: 14px;
        }
        
        .control-panel {
            background: rgba(20, 20, 40, 0.95);
            padding: 25px;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #00ccff;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .form-group input,
        .form-group button {
            width: 100%;
            padding: 12px;
            font-size: 14px;
            border-radius: 4px;
            border: 1px solid #333;
        }
        
        .form-group input {
            background: #0a0a1a;
            color: #00ff88;
            font-family: 'Courier New', monospace;
        }
        
        .form-group input::placeholder {
            color: #555;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #0066cc;
            background: #0d0d22;
            box-shadow: 0 0 8px rgba(0, 102, 204, 0.3);
        }
        
        .form-group button {
            background: linear-gradient(135deg, #0066cc 0%, #0052a3 100%);
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            border: none;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
        }
        
        .form-group button:hover {
            background: linear-gradient(135deg, #0073e6 0%, #005cb8 100%);
            box-shadow: 0 4px 12px rgba(0, 102, 204, 0.4);
        }
        
        .form-group button:active {
            transform: translateY(1px);
        }
        
        .case-info {
            background: rgba(20, 20, 40, 0.95);
            padding: 25px;
            margin-bottom: 30px;
            border-radius: 8px;
            border-left: 4px solid #00cc66;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            display: none;
        }
        
        .case-info.active {
            display: block;
        }
        
        .case-info h2 {
            color: #00ff88;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .info-item {
            background: rgba(0, 10, 20, 0.5);
            padding: 12px;
            border-radius: 4px;
            border-left: 3px solid #0066cc;
        }
        
        .info-item strong {
            color: #00ccff;
            display: block;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }
        
        .info-item span {
            color: #00ff88;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            word-break: break-all;
        }
        
        .evidence-list {
            background: rgba(20, 20, 40, 0.95);
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            display: none;
        }
        
        .evidence-list.active {
            display: block;
        }
        
        .evidence-list h2 {
            color: #00ff88;
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        .evidence-item {
            background: rgba(0, 10, 20, 0.5);
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 4px;
            border-left: 3px solid #0099ff;
        }
        
        .evidence-item h3 {
            color: #00ccff;
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .evidence-item p {
            color: #a0a0c0;
            font-size: 13px;
            margin-bottom: 8px;
        }
        
        .evidence-item a {
            color: #0099ff;
            text-decoration: none;
            font-size: 12px;
            font-family: 'Courier New', monospace;
            word-break: break-all;
        }
        
        .evidence-item a:hover {
            color: #00ccff;
            text-decoration: underline;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .status-success {
            background: rgba(0, 200, 100, 0.2);
            color: #00ff88;
            border: 1px solid #00cc66;
        }
        
        .status-pending {
            background: rgba(200, 150, 0, 0.2);
            color: #ffcc00;
            border: 1px solid #ff9900;
        }
        
        .status-error {
            background: rgba(200, 0, 0, 0.2);
            color: #ff6666;
            border: 1px solid #cc0000;
        }
        
        .loading {
            text-align: center;
            color: #00ccff;
            font-size: 14px;
        }
        
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 102, 204, 0.3);
            border-radius: 50%;
            border-top-color: #0066cc;
            animation: spin 0.8s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .error-message {
            background: rgba(200, 0, 0, 0.1);
            color: #ff6666;
            padding: 12px;
            border-radius: 4px;
            border-left: 3px solid #cc0000;
            margin-top: 10px;
            font-size: 13px;
        }
        
        .footer {
            margin-top: 40px;
            padding: 20px;
            text-align: center;
            color: #666;
            font-size: 12px;
            border-top: 1px solid #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîó Patterstone Case - On-Chain Evidence Portal</h1>
            <p>Immutable evidence registry for Yoda Burns v. Monisha | 3530 Patterstone Drive, Alpharetta, GA</p>
        </header>
        
        <div class="control-panel">
            <h2 style="color: #00ff88; margin-bottom: 20px;">Connect to Blockchain</h2>
            
            <div class="form-group">
                <label>Ethereum RPC Endpoint</label>
                <input type="text" id="rpcUrl" placeholder="https://sepolia.infura.io/v3/YOUR_KEY" value="https://sepolia.infura.io/v3/">
            </div>
            
            <div class="form-group">
                <label>Contract Address</label>
                <input type="text" id="contractAddress" placeholder="0x..." value="">
            </div>
            
            <div class="form-group">
                <button onclick="loadCase()">Load Case from Blockchain</button>
            </div>
        </div>
        
        <div id="loading" class="loading" style="display: none;">
            <div class="spinner"></div>
            <span>Connecting to blockchain...</span>
        </div>
        
        <div id="caseInfo" class="case-info">
            <h2>üìã Case Metadata</h2>
            <div class="info-grid">
                <div class="info-item">
                    <strong>Plaintiff</strong>
                    <span id="plaintiff">-</span>
                </div>
                <div class="info-item">
                    <strong>Defendant</strong>
                    <span id="defendant">-</span>
                </div>
                <div class="info-item">
                    <strong>Property</strong>
                    <span id="property">-</span>
                </div>
                <div class="info-item">
                    <strong>Jurisdiction</strong>
                    <span id="jurisdiction">-</span>
                </div>
                <div class="info-item">
                    <strong>Contract Status</strong>
                    <span id="contractStatus">-</span>
                </div>
                <div class="info-item">
                    <strong>Evidence Count</strong>
                    <span id="evidenceCount">-</span>
                </div>
            </div>
        </div>
        
        <div id="evidenceList" class="evidence-list">
            <h2>üîê Registered Evidence (On-Chain)</h2>
            <div id="evidenceItems"></div>
        </div>
        
        <div id="error" class="error-message" style="display: none;"></div>
    </div>
    
    <div class="footer">
        <p>This portal retrieves immutable case data from the Ethereum blockchain.</p>
        <p>Evidence hashes are cryptographically signed and timestamped. Content stored on IPFS.</p>
        <p>No wallet required - Read-only verification via public RPC endpoint.</p>
    </div>
    
    <script src="https://cdn.ethers.org/v6/ethers.umd.js"></script>
    <script>
        const ABI = [
            "function caseId() view returns (string)",
            "function propertyAddress() view returns (string)",
            "function jurisdiction() view returns (string)",
            "function plaintiff() view returns (string)",
            "function defendant() view returns (string)",
            "function isClosed() view returns (bool)",
            "function evidenceCount() view returns (uint256)",
            "function getEvidence(uint256) view returns (uint256, string, string, string, string, uint256, address)"
        ];
        
        async function loadCase() {
            const rpcUrl = document.getElementById('rpcUrl').value;
            const contractAddress = document.getElementById('contractAddress').value;
            const loading = document.getElementById('loading');
            const error = document.getElementById('error');
            
            error.style.display = 'none';
            loading.style.display = 'block';
            
            try {
                if (!contractAddress || contractAddress === '0x') {
                    throw new Error('Please enter a valid contract address');
                }
                
                const provider = new ethers.JsonRpcProvider(rpcUrl);
                const contract = new ethers.Contract(contractAddress, ABI, provider);
                
                const caseId = await contract.caseId();
                const propertyAddress = await contract.propertyAddress();
                const jurisdiction = await contract.jurisdiction();
                const plaintiff = await contract.plaintiff();
                const defendant = await contract.defendant();
                const isClosed = await contract.isClosed();
                const count = await contract.evidenceCount();
                
                document.getElementById('plaintiff').textContent = plaintiff;
                document.getElementById('defendant').textContent = defendant;
                document.getElementById('property').textContent = propertyAddress;
                document.getElementById('jurisdiction').textContent = jurisdiction;
                document.getElementById('contractStatus').innerHTML = 
                    `<span class="status-badge ${isClosed ? 'status-success' : 'status-pending'}">
                        ${isClosed ? 'SEALED' : 'ACTIVE'}
                    </span>`;
                document.getElementById('evidenceCount').textContent = count.toString();
                document.getElementById('caseInfo').classList.add('active');
                
                const evidenceItemsDiv = document.getElementById('evidenceItems');
                evidenceItemsDiv.innerHTML = '';
                
                for (let i = 1; i <= Math.min(count, 100); i++) {
                    const [id, externalId, category, description, ipfsHash, createdAt, submittedBy] = 
                        await contract.getEvidence(i);
                    
                    const date = new Date(Number(createdAt) * 1000).toISOString().split('T')[0];
                    const ipfsUrl = `https://gateway.pinata.cloud/ipfs/${ipfsHash}`;
                    
                    const item = document.createElement('div');
                    item.className = 'evidence-item';
                    item.innerHTML = `
                        <h3>${externalId} - ${category.toUpperCase()}</h3>
                        <p>${description}</p>
                        <div style="font-size: 12px; color: #666; margin-bottom: 10px;">
                            <strong>Timestamp:</strong> ${date}<br>
                            <strong>IPFS Hash:</strong> <code style="font-family: monospace;">${ipfsHash}</code>
                        </div>
                        <a href="${ipfsUrl}" target="_blank" rel="noopener">View on IPFS Gateway ‚Üí</a>
                    `;
                    evidenceItemsDiv.appendChild(item);
                }
                
                document.getElementById('evidenceList').classList.add('active');
                
            } catch (err) {
                error.style.display = 'block';
                error.textContent = `Error: ${err.message}`;
                console.error(err);
            } finally {
                loading.style.display = 'none';
            }
        }
        
        document.getElementById('contractAddress').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') loadCase();
        });
    </script>
</body>
</html>
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .alert-success {
            background: #f0fff4;
            border-left-color: #48bb78;
        }
        
        .alert-error {
            background: #fff5f5;
            border-left-color: #f56565;
        }
        
        .section {
            margin: 30px 0;
            padding: 25px;
            background: #f7fafc;
            border-radius: 12px;
        }
        
        .section h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        .input-group {
            margin: 20px 0;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #4a5568;
            font-weight: 600;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 14px 32px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin: 10px 0;
        }
        
        .stat-label {
            color: #718096;
            font-size: 1em;
        }
        
        .result-box {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .verified-check {
            font-size: 3em;
            color: #48bb78;
            text-align: center;
            margin: 20px 0;
        }
        
        .not-verified {
            font-size: 3em;
            color: #f56565;
            text-align: center;
            margin: 20px 0;
        }
        
        .evidence-details {
            margin: 20px 0;
        }
        
        .evidence-details dt {
            font-weight: 600;
            color: #4a5568;
            margin-top: 15px;
        }
        
        .evidence-details dd {
            margin-left: 20px;
            color: #718096;
            word-break: break-all;
        }
        
        .link {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
        }
        
        .link:hover {
            text-decoration: underline;
        }
        
        .timeline-container {
            margin: 30px 0;
        }
        
        .timeline-item {
            position: relative;
            padding-left: 40px;
            margin-bottom: 30px;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 8px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #667eea;
            box-shadow: 0 0 0 4px #e6f2ff;
        }
        
        .timeline-item.critical::before {
            background: #f56565;
            box-shadow: 0 0 0 4px #fee;
        }
        
        .timeline-item.bad-faith::before {
            background: #ed8936;
            box-shadow: 0 0 0 4px #fffaf0;
        }
        
        .timeline-date {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .timeline-event {
            font-size: 1.1em;
            color: #2d3748;
            margin-bottom: 5px;
        }
        
        .timeline-description {
            color: #718096;
            font-size: 0.95em;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin: 5px 5px 5px 0;
        }
        
        .badge-critical {
            background: #fee;
            color: #c53030;
        }
        
        .badge-bad-faith {
            background: #fffaf0;
            color: #c05621;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #718096;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
            color: #718096;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîí Blockchain Evidence Verification</h1>
            <div class="case-id">Yoda Burns v. Monisha [Last Name]</div>
            <div class="case-id">3530 Patterstone Dr, Alpharetta, GA</div>
        </header>
        
        <div class="alert">
            <strong>üõ°Ô∏è Tamper-Proof Evidence</strong><br>
            This case is fully documented on the Ethereum blockchain, making all evidence permanent, immutable, and publicly verifiable. 
            No one can alter, delete, or deny this record.
        </div>
        
        <!-- Case Statistics -->
        <div class="section">
            <h2>üìä Case Statistics</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Evidence Items</div>
                    <div class="stat-value" id="evidenceCount">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Timeline Events</div>
                    <div class="stat-value" id="timelineCount">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Payment Record</div>
                    <div class="stat-value" id="paymentReliability">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Bad Faith Events</div>
                    <div class="stat-value" id="badFaithCount">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Rent Paid During Breach</div>
                    <div class="stat-value" id="rentPaid">-</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Estimated Damages</div>
                    <div class="stat-value" id="totalDamages">-</div>
                </div>
            </div>
        </div>
        
        <!-- Evidence Verification -->
        <div class="section">
            <h2>üîç Verify Evidence</h2>
            <p style="margin-bottom: 20px; color: #718096;">
                Enter the SHA-256 hash of any document or photo to verify its authenticity and timestamp on the blockchain.
            </p>
            
            <div class="input-group">
                <label for="hashInput">SHA-256 Hash:</label>
                <input type="text" id="hashInput" placeholder="0xa3f7b2c9d5e8f1a4b7c2d6e9f3a8b1c4d7e2f5a9b3c6d1e4f8a2b5c9d3e7f1a4">
            </div>
            
            <button onclick="verifyEvidence()" style="width: 100%;">Verify on Blockchain</button>
            
            <div id="verificationResult"></div>
        </div>
        
        <!-- Contract Information -->
        <div class="section">
            <h2>üìú Smart Contract</h2>
            <div class="evidence-details">
                <dl>
                    <dt>Contract Address:</dt>
                    <dd><a href="https://etherscan.io/address/0x[CONTRACT_ADDRESS]" target="_blank" class="link" id="contractAddress">Loading...</a></dd>
                    
                    <dt>IPFS Root:</dt>
                    <dd><a href="https://ipfs.io/ipfs/[IPFS_HASH]" target="_blank" class="link" id="ipfsRoot">Loading...</a></dd>
                    
                    <dt>Case Status:</dt>
                    <dd id="caseStatus">Loading...</dd>
                    
                    <dt>Blockchain Network:</dt>
                    <dd>Ethereum Mainnet</dd>
                </dl>
            </div>
        </div>
        
        <!-- Timeline -->
        <div class="section">
            <h2>üìÖ Case Timeline</h2>
            <div id="timeline" class="loading">
                <div class="spinner"></div>
                Loading timeline from blockchain...
            </div>
        </div>
        
        <footer>
            <p><strong>Web3 Justice:</strong> Using blockchain technology to ensure transparency and accountability.</p>
            <p style="margin-top: 10px; font-size: 0.9em;">
                This is the first landlord-tenant case with fully blockchain-documented evidence.
            </p>
        </footer>
    </div>
    
    <script>
        // Configuration - UPDATE THESE AFTER DEPLOYMENT
        const CONTRACT_ADDRESS = '0x[INSERT_CONTRACT_ADDRESS]';
        const IPFS_ROOT = 'Qm[INSERT_ROOT_HASH]';
        
        // Contract ABI (simplified - include relevant functions)
        const CONTRACT_ABI = [
            "function getEvidenceCount() view returns (uint256)",
            "function getTimelineCount() view returns (uint256)",
            "function verifyEvidence(bytes32) view returns (bool exists, uint256 evidenceId, uint256 timestamp, string ipfsHash, string description)",
            "function getCaseStats() view returns (uint256 evidenceCount, uint256 timelineEventCount, uint256 paymentCount, uint256 damageCount, uint256 totalRent, uint256 onTimePercent, uint256 badFaithEvents, uint256 criticalEvents, uint256 totalDamageAmount)",
            "function getPaymentReliability() view returns (uint256)",
            "function caseStatus() view returns (string)"
        ];
        
        let provider;
        let contract;
        
        // Initialize on page load
        window.addEventListener('load', async () => {
            await initWeb3();
            await loadCaseStats();
            await loadTimeline();
        });
        
        async function initWeb3() {
            try {
                // Use public provider (doesn't require MetaMask)
                provider = new ethers.providers.JsonRpcProvider('https://mainnet.infura.io/v3/[YOUR_INFURA_KEY]');
                
                // Or use ethers default provider
                // provider = ethers.getDefaultProvider('homestead');
                
                contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, provider);
                
                console.log('Web3 initialized');
            } catch (error) {
                console.error('Error initializing Web3:', error);
                document.getElementById('evidenceCount').textContent = 'Error';
            }
        }
        
        async function loadCaseStats() {
            try {
                const stats = await contract.getCaseStats();
                const reliability = await contract.getPaymentReliability();
                const status = await contract.caseStatus();
                
                document.getElementById('evidenceCount').textContent = stats.evidenceCount.toString();
                document.getElementById('timelineCount').textContent = stats.timelineEventCount.toString();
                document.getElementById('paymentReliability').textContent = reliability.toString() + '%';
                document.getElementById('badFaithCount').textContent = stats.badFaithEvents.toString();
                document.getElementById('rentPaid').textContent = '$' + (stats.totalRent / 100).toLocaleString();
                document.getElementById('totalDamages').textContent = '$' + (stats.totalDamageAmount / 100).toLocaleString();
                document.getElementById('caseStatus').textContent = status;
                document.getElementById('contractAddress').href = `https://etherscan.io/address/${CONTRACT_ADDRESS}`;
                document.getElementById('contractAddress').textContent = CONTRACT_ADDRESS;
                document.getElementById('ipfsRoot').href = `https://ipfs.io/ipfs/${IPFS_ROOT}`;
                document.getElementById('ipfsRoot').textContent = IPFS_ROOT;
            } catch (error) {
                console.error('Error loading case stats:', error);
            }
        }
        
        async function verifyEvidence() {
            const hashInput = document.getElementById('hashInput').value.trim();
            const resultDiv = document.getElementById('verificationResult');
            
            if (!hashInput) {
                resultDiv.innerHTML = '<div class="alert alert-error">Please enter a SHA-256 hash</div>';
                return;
            }
            
            resultDiv.innerHTML = '<div class="loading"><div class="spinner"></div>Verifying on blockchain...</div>';
            
            try {
                // Convert hash to bytes32 format if needed
                let hashBytes32 = hashInput;
                if (!hashInput.startsWith('0x')) {
                    hashBytes32 = '0x' + hashInput;
                }
                
                const result = await contract.verifyEvidence(hashBytes32);
                
                if (result.exists) {
                    const date = new Date(result.timestamp * 1000);
                    resultDiv.innerHTML = `
                        <div class="result-box">
                            <div class="verified-check">‚úÖ</div>
                            <h3 style="text-align: center; color: #48bb78; margin-bottom: 20px;">VERIFIED!</h3>
                            <div class="alert alert-success">
                                This evidence exists on the blockchain and has not been tampered with.
                            </div>
                            <dl class="evidence-details">
                                <dt>Evidence ID:</dt>
                                <dd>${result.evidenceId.toString()}</dd>
                                
                                <dt>Description:</dt>
                                <dd>${result.description}</dd>
                                
                                <dt>Blockchain Timestamp:</dt>
                                <dd>${date.toLocaleString()}</dd>
                                
                                <dt>IPFS Link:</dt>
                                <dd><a href="https://ipfs.io/ipfs/${result.ipfsHash}" target="_blank" class="link">${result.ipfsHash}</a></dd>
                                
                                <dt>Verification Status:</dt>
                                <dd><span style="color: #48bb78; font-weight: bold;">‚úì AUTHENTIC & UNALTERED</span></dd>
                            </dl>
                            <p style="margin-top: 20px; font-size: 0.9em; color: #718096;">
                                This evidence was cryptographically secured on the Ethereum blockchain and stored on IPFS. 
                                It cannot be altered or deleted.
                            </p>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="result-box">
                            <div class="not-verified">‚ùå</div>
                            <div class="alert alert-error">
                                <strong>Not Found</strong><br>
                                This hash does not exist in the blockchain record for this case.
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Verification error:', error);
                resultDiv.innerHTML = `
                    <div class="alert alert-error">
                        <strong>Error:</strong> ${error.message}
                    </div>
                `;
            }
        }
        
        async function loadTimeline() {
            // Load from evidence_manifest.json (for demo) or from blockchain
            // In production, this would query the contract's timeline events
            const timelineDiv = document.getElementById('timeline');
            
            try {
                // Fetch timeline from JSON file
                const response = await fetch('evidence_manifest.json');
                const data = await response.json();
                
                let html = '<div class="timeline-container">';
                
                data.timeline.forEach(event => {
                    const classes = ['timeline-item'];
                    if (event.critical) classes.push('critical');
                    if (event.bad_faith_event) classes.push('bad-faith');
                    
                    html += `
                        <div class="${classes.join(' ')}">
                            <div class="timeline-date">${event.date}</div>
                            <div class="timeline-event">${event.event}</div>
                            <div class="timeline-description">${event.description}</div>
                            <div style="margin-top: 8px;">
                                ${event.critical ? '<span class="badge badge-critical">CRITICAL</span>' : ''}
                                ${event.bad_faith_event ? '<span class="badge badge-bad-faith">BAD FAITH</span>' : ''}
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                timelineDiv.innerHTML = html;
            } catch (error) {
                console.error('Error loading timeline:', error);
                timelineDiv.innerHTML = '<div class="alert alert-error">Error loading timeline</div>';
            }
        }
        
        // Allow Enter key to verify
        document.getElementById('hashInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                verifyEvidence();
            }
        });
    </script>
</body>
</html>
